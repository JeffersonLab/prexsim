{
  

  Double_t total;
  Double_t sum=0;
  Double_t binCenter[200];
  Double_t binCounts[200];

  TFile *_file0 = TFile::Open("/home/crowder/scratch/ROOTfiles/prex_1e6_QGSP_BERT_HP_5mmtgt_coll_no_dump.root");

  Double_t minE[4]={0.00,1.000,100.,0.1};
  Double_t maxE[4]={1.00,100.0,500.,1060.};
  //  Double_t maxE[4]={1.00,50.0,500.,4000.};

  Int_t en1=3;
  Int_t en2=3;


  TH1F* h1 = new TH1F("h1","Neutron counts per incident electron",200,minE[en1],maxE[en2]);
  TH1F* h2 = new TH1F("h2","Neutron counts per incident electron",200,minE[en1],maxE[en2]);

  Int_t volume =0;
  Int_t particle =5;

  char cut1[200];
  sprintf(cut1,"(volume==%i&&type==%i&&kineE>%f&&kineE<%f)*(1/1000000)",volume,particle,minE[en1],maxE[en2]);

  TCanvas *c1 = new TCanvas("c1");
 
  c1->Divide(1,1);
  c1->cd(1);

  h1->SetLineColor(1);
  h1->GetXaxis()->SetTitle("Energy (MeV)");
  h1->GetYaxis()->SetTitle("Counts");
  h1->SetStats(0);
  h1->SetMinimum(1e-12);
  geant->Draw("kineE>>h1",cut1,"");

  total=h1->Integral();

  TAxis *xaxis = h1->GetXaxis();

  for (Int_t j=0;j<200-1;j++){
    binCenter[j] = xaxis->GetBinCenter(j+1);
    binCounts[j] = h1->GetBinContent(j+1);
    //    cout<<binCenter[j]<<"\t"<<binCounts[j]<<endl;
        sum=sum+binCounts[j];
  }
  cout<<"Total = Sum?  "<<total<<" = "<<sum<<endl;


  //  TFile *_file1 = TFile::Open("/home/crowder/scratch/ROOTfiles/prexsim_shldgeo_1e6_none_QGSC-1_sim_0.root");
  TFile *_file1 = TFile::Open("/home/crowder/scratch/ROOTfiles/prexsim_shldgeo_1e6_none-1_sim_4.root");
  h2->SetLineColor(2);
  geant->Draw("kineE>>h2",cut1,"same");



  Double_t xmin=0.6,xmax=0.75, ymin=0.7, ymax=0.8;
  TLegend *leg = new TLegend(xmin,ymin,xmax,ymax,NULL,"brNDC");
  leg->SetTextFont(62);
  leg->SetTextSize(0.03);
  leg->SetLineColor(1);
  leg->SetLineStyle(1);
  leg->SetLineWidth(1);
  leg->SetFillColor(19);
  leg->SetFillStyle(1001);
  TLegendEntry *entry=leg->AddEntry("c1","5 mm Pb, w/ coll","l");
  entry->SetLineColor(1);
  entry=leg->AddEntry("c1","5 mm Pb, w/ coll (QGSC)","l");
  entry->SetLineColor(2);

  leg->Draw();
  c1->Modified();
  c1->cd();
  c1->SetSelected(c1);

}
