// Macro to plot the transverse world data with the
// theory calculations provided by B. Pasquini 
// October 2010

{

gROOT->Reset();
#include "Riostream.h"

  // ===================================================================
  // Define some variables

  Int_t n = 6;

  Float_t th_err[n]={0.,0.,0.,0.,0.,0.};

  Float_t th_conc[n]={0,10,20,30,40,50};
  //  Float_t th_poly[n]={0,10,20,30,40,50};
  Float_t th_poly[n]={0,10,15,20,25,30};
  Float_t th_iron[n]={0,5,8,11,14,17};

  Float_t n_neut_conc_en1[n]={0.00500152, 0.00569089,0.00336245,0.00163181,0.000771105,0.000345302};
  Float_t n_neut_conc_en2[n]={0.00398462, 0.00196201,0.000889203,0.0003792,0.0001917,9.17e-05};
  Float_t n_neut_conc_en3[n]={3.27e-05, 2.42e-05,1.88e-05,1.34e-05,1.27e-05,9.5e-06};

  /*
  Float_t n_neut_poly_en1[n]={0.00500152, 0.00184621,0.000302302,7.02003e-05,1.87e-05,1.18e-05};
  Float_t n_neut_poly_en2[n]={0.00398462, 0.000840202,0.0002417,8.3e-05,3.79e-05,2.51e-05};
  Float_t n_neut_poly_en3[n]={3.27e-05, 2.74e-05,2.45e-05,1.9e-05,1.3e-05,1.56e-05};
  */
  Float_t n_neut_poly_en1[n]={0.0030432,0.00190441,0.00119021,0.000787704,0.000554202,0.000400502};
  Float_t n_neut_poly_en2[n]={0.00271042,0.0010282,0.000672001,0.000464,0.0003334,0.0002714};
  Float_t n_neut_poly_en3[n]={2.43e-05,1.98e-05,1.97e-05,1.93e-05,1.76e-05,1.81e-05};
 
  Float_t n_neut_iron_en1[n]={0.00500152,0.00648543,0.00732393,0.00784434,0.00817184,0.00815934};
  Float_t n_neut_iron_en2[n]={0.00398462,0.00276702,0.00208271,0.00150241,0.0010972,0.000791703};
  Float_t n_neut_iron_en3[n]={3.27e-05,1.94e-05,1.64e-05,1.26e-05,1.26e-05,1.01e-05};
  
  Float_t n_neut_conc_en1_err[n]={0.,0.,0.,0.,0.,0.};
  Float_t n_neut_conc_en2_err[n]={0.,0.,0.,0.,0.,0.};
  Float_t n_neut_conc_en3_err[n]={0.,0.,0.,0.,0.,0.};
  
  Float_t n_neut_poly_en1_err[n]={0.,0.,0.,0.,0.,0.};
  Float_t n_neut_poly_en2_err[n]={0.,0.,0.,0.,0.,0.};
  Float_t n_neut_poly_en3_err[n]={0.,0.,0.,0.,0.,0.};

  Float_t n_neut_iron_en1_err[n]={0.,0.,0.,0.,0.,0.};
  Float_t n_neut_iron_en2_err[n]={0.,0.,0.,0.,0.,0.};
  Float_t n_neut_iron_en3_err[n]={0.,0.,0.,0.,0.,0.};
  

  // ===================================================================
  // Make plots


  TCanvas c1("c1","c1",200,200,600,400);

  TGraphErrors *gr1 = new TGraphErrors(n,th_poly,n_neut_poly_en1,th_err,n_neut_poly_en1_err);
  gr1->SetMarkerStyle(21);
  gr1->SetMarkerColor(1);
  //  gr1->SetMarkerStyle(22);
  //  gr1->SetMarkerColor(2);
  gr1->Draw("AP");
  gr1->GetXaxis()->SetLabelSize(0.04);
  gr1->GetXaxis()->SetTitleSize(0.04);
  gr1->GetYaxis()->SetTitleOffset(0.7);
  gr1->GetXaxis()->SetTitle("Thickness (cm)");
  gr1->GetYaxis()->SetLabelSize(0.04);
  gr1->GetYaxis()->SetTitleSize(0.04);
  gr1->GetYaxis()->SetTitleOffset(1.4);
  gr1->GetYaxis()->SetTitle("Counts (per incident e-)");
  gr1->GetYaxis()->SetRangeUser(0,.006);
  gr1->GetYaxis()->SetRangeUser(1e-6,1e-2);
  gr1->SetTitle("Polyethylene");


  TGraphErrors *gr2 = new TGraphErrors(n,th_poly,n_neut_poly_en2,th_err,n_neut_poly_en2_err);
  gr2->SetMarkerStyle(21);
  gr2->SetMarkerColor(2);
  gr2->SetLineWidth(2);
  //  gr2->SetMarkerStyle(22);
  //  gr2->SetMarkerColor(1);
  gr2->Draw("P");

  TGraphErrors *gr3 = new TGraphErrors(n,th_poly,n_neut_poly_en3,th_err,n_neut_poly_en3_err);
  gr3->SetMarkerStyle(21);
  gr3->SetMarkerColor(4);
  gr3->SetLineWidth(2);
  //  gr2->SetMarkerStyle(22);
  //  gr2->SetMarkerColor(1);
  gr3->Draw("P");



  leg = new TLegend(0.85,0.55,0.48,0.85);
  leg->AddEntry(gr1,"Neutron counts, 0<E<1 MeV","p");
  leg->AddEntry(gr2,"Neutron counts, 1<E<50 MeV","p");
  leg->AddEntry(gr3,"Neutron counts, 50<E<500 MeV","p");
  leg->Draw();
   
}

