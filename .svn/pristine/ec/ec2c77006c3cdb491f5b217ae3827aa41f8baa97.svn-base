{

  cout<<"Chaining sims..."<<endl;
  //10 -50 is really 5-17 for now...
  TChain geantFe10Tree("geant");
  TChain geantFe20Tree("geant");
  TChain geantFe30Tree("geant");
  TChain geantFe40Tree("geant");
  TChain geantFe50Tree("geant");

  char name[200];

  for (Int_t i=0;i<10;i++){
    sprintf(name,"~/scratch/ROOTfiles/prexsim_shldgeo_1e6_Fe5_sim_%i.root",i);
    geantFe10Tree->Add(name);
    cout<<name<<endl;
  }
  for (Int_t i=0;i<10;i++){
    sprintf(name,"~/scratch/ROOTfiles/prexsim_shldgeo_1e6_Fe8_sim_%i.root",i);
    geantFe20Tree->Add(name);
    cout<<name<<endl;
  }
  for (Int_t i=0;i<10;i++){
    sprintf(name,"~/scratch/ROOTfiles/prexsim_shldgeo_1e6_Fe11_sim_%i.root",i);
    geantFe30Tree->Add(name);
    cout<<name<<endl;
  }
  for (Int_t i=0;i<10;i++){
    sprintf(name,"~/scratch/ROOTfiles/prexsim_shldgeo_1e6_Fe14_sim_%i.root",i);
    geantFe40Tree->Add(name);
    cout<<name<<endl;
  }
  for (Int_t i=0;i<10;i++){
    sprintf(name,"~/scratch/ROOTfiles/prexsim_shldgeo_1e6_Fe17_sim_%i.root",i);
    geantFe50Tree->Add(name);
    cout<<name<<endl;
  }


  //--------------------------------------------------
  // Set up some cuts, etc.
  Double_t total_neutrons[15];

  Double_t minE[3]={0.00,1.00,50.0};
  Double_t maxE[3]={1.00,50.0,500.};

  TH1F* h[15];
  char hname[15][200];
  char plot[15][200];

  Int_t k=0;
 
  Int_t volume =0;
  Int_t particle =5;

  char cut[3][200];

  cout<<endl;
  for(Int_t en=0;en<3;en++){
    for (Int_t pl=0;pl<5;pl++){

      sprintf(cut[en],"(volume==%i&&type==%i&&kineE>%f&&kineE<%f)*(1/10000000)",volume,particle,minE[en],maxE[en]);
      sprintf(hname[k],"h%i",k);
      //      h[k] = new TH1F(hname[k],"Neutron counts per incident electron, polyethylene",200,minE[en],maxE[en]);
      h[k] = new TH1F(hname[k],"Neutron counts per incident electron, iron",200,minE[en],maxE[en]);
      //      h[k] = new TH1F(hname[k],"Neutron counts per incident electron, concrete",200,minE[en],maxE[en]);
      sprintf(plot[k],"kineE>>h%i",k);
      cout<<hname[k]<<" "<<plot[k]<<" "<<cut[en]<<endl;
      k++;

    }
  }
  cout<<endl;

  //--------------------------------------------------
  // Make the plots
  cout<<"Making the plots..."<<endl;

  TCanvas *c1 = new TCanvas("c1");
 
  c1->Divide(1,3);
  c1->cd(1);

  h[0]->SetLineColor(1);
  h[0]->GetXaxis()->SetTitle("Energy (MeV)");
  h[0]->GetYaxis()->SetTitle("Counts");
  h[0]->SetStats(0);
  h[0]->SetMinimum(1e-8);
  h[0]->SetMaximum(1e-2);

  geantFe10Tree->Draw(plot[0],cut[0],"");
  total_neutrons[0]=h[0]->Integral();

  h[1]->SetLineColor(2);
  geantFe20Tree->Draw(plot[1],cut[0],"same");
  total_neutrons[1]=h[1]->Integral();

  h[2]->SetLineColor(3);
  geantFe30Tree->Draw(plot[2],cut[0],"same");
  total_neutrons[2]=h[2]->Integral();

  h[3]->SetLineColor(4);
  geantFe40Tree->Draw(plot[3],cut[0],"same");
  total_neutrons[3]=h[3]->Integral();

  h[4]->SetLineColor(5);
  geantFe50Tree->Draw(plot[4],cut[0],"same");
  total_neutrons[4]=h[4]->Integral();

  //----------------------
  c1->cd(2);

  h[5]->SetLineColor(1);
  h[5]->GetXaxis()->SetTitle("Energy (MeV)");
  h[5]->GetYaxis()->SetTitle("Counts");
  h[5]->SetStats(0);
  h[5]->SetMinimum(1e-8);
  h[5]->SetMaximum(2e-3);

  geantFe10Tree->Draw(plot[5],cut[1],"");
  total_neutrons[5]=h[5]->Integral();

  h[6]->SetLineColor(2);
  geantFe20Tree->Draw(plot[6],cut[1],"same");
  total_neutrons[6]=h[6]->Integral();

  h[7]->SetLineColor(3);
  geantFe30Tree->Draw(plot[7],cut[1],"same");
  total_neutrons[7]=h[7]->Integral();

  h[8]->SetLineColor(4);
  geantFe40Tree->Draw(plot[8],cut[1],"same");
  total_neutrons[8]=h[8]->Integral();

  h[9]->SetLineColor(5);
  geantFe50Tree->Draw(plot[9],cut[1],"same");
  total_neutrons[9]=h[9]->Integral();  

  //----------------------
  //Make the legend
  Double_t xmin=0.6,xmax=0.75, ymin=0.5, ymax=0.8;
   TLegend *leg = new TLegend(xmin,ymin,xmax,ymax,NULL,"brNDC");
   leg->SetTextFont(62);
   leg->SetTextSize(0.03);
   leg->SetFillColor(19);
   leg->SetFillStyle(1001);
   TLegendEntry *entry=leg->AddEntry("c1","5 cm thick","l");
   entry->SetLineColor(1);

   entry=leg->AddEntry("c1","8 cm thick","l");
   entry->SetLineColor(2);

   entry=leg->AddEntry("c1","11 cm thick","l");
   entry->SetLineColor(3);

   entry=leg->AddEntry("c1","14 cm thick","l");
   entry->SetLineColor(4);

   entry=leg->AddEntry("c1","17 cm thick","l");
   entry->SetLineColor(5);


   leg->Draw();

  //----------------------
  c1->cd(3);

  h[10]->SetLineColor(1);
  h[10]->GetXaxis()->SetTitle("Energy (MeV)");
  h[10]->GetYaxis()->SetTitle("Counts");
  h[10]->SetStats(0);
  h[10]->SetMinimum(1e-8);
  h[10]->SetMaximum(2e-3);

  geantFe10Tree->Draw(plot[10],cut[2],"");
  total_neutrons[10]=h[10]->Integral();

  h[11]->SetLineColor(2);
  geantFe20Tree->Draw(plot[11],cut[2],"same");
  total_neutrons[11]=h[11]->Integral();

  h[12]->SetLineColor(3);
  geantFe30Tree->Draw(plot[12],cut[2],"same");
  total_neutrons[12]=h[12]->Integral();

  h[13]->SetLineColor(4);
  geantFe40Tree->Draw(plot[13],cut[2],"same");
  total_neutrons[13]=h[13]->Integral();

  h[14]->SetLineColor(5);
  geantFe50Tree->Draw(plot[14],cut[2],"same");
  total_neutrons[14]=h[14]->Integral();
  

   c1->Modified();
   c1->cd();
   c1->SetSelected(c1);

   k=0;
   for(Int_t en=0;en<3;en++){
    for (Int_t pl=0;pl<5;pl++){
      cout<<"The total number of neutrons for "<<minE[en]<<"<E<"<<maxE[en]<<" MeV and a iron thickness of "<<5+pl*3<<" is "<< total_neutrons[k]<<endl;
     k++;
   }
  }
  
}
